"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["gallery__mixins_findSubPageSource_js-gallery__components_alePages_aleGallery_aleSearch_vue"],{3486:(e,t,s)=>{s.d(t,{Z:()=>i});const i={data:function(){return{subPageSource:{collection:null,name:null,wishlist:!1,library:!1,books:!1}}},methods:{findSubPageSource:function(){var e=this.$route.query.subPageSource||this.$store.state.sticky.subPageSource;return{collection:this.$store.state.library[e],name:e,wishlist:"wishlist"===e,library:"books"===e,books:"books"===e}}},watch:{"$route.query.subPageSource":function(e){!this.$route.meta.gallery&&this.$route.meta.subPage&&(this.listReady=!1,this.$nextTick((function(){this.subPageSource=this.findSubPageSource(),this.makeCollection()})))}},beforeCreate:function(){this.$store.commit("prop",{key:"pageCollection",value:[]}),this.$store.commit("prop",{key:"mutatingCollection",value:[]})},created:function(){this.$route.meta.subPage&&(this.subPageSource=this.findSubPageSource()),!this.$route.meta.gallery&&this.$route.meta.subPage&&this.makeCollection()}}},730:(e,t,s)=>{s.d(t,{Z:()=>i}),s(2759),s(2077),s(895),s(2482),s(911),s(3238);const i={methods:{slugify:function(e){var t="àáâäæãåāăąçćčđďèéêëēėęěğǵḧîïíīįìłḿñńǹňôöòóœøōõőṕŕřßśšşșťțûüùúūǘůűųẃẍÿýžźż·/_,:;",s=new RegExp(t.split("").join("|"),"g");return encodeURIComponent(e.toString().toLowerCase().replace(/\s+/g,"-").replace(s,(function(e){return"aaaaaaaaaacccddeeeeeeeegghiiiiiilmnnnnoooooooooprrsssssttuuuuuuuuuwxyyzzz------".charAt(t.indexOf(e))})).replace(/&/g,"-and-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,""))}}}},5619:(e,t,s)=>{s.d(t,{Z:()=>i}),s(2077),s(1203);const i={methods:{timeStringToSeconds:function(e){if(e&&e.match(/\d/)){var t=e.match(/[0-9]( ?)+(m|min|分)/),s=e.match(/\d+/g),i={},r=function(e){return 60*+e*60},o=function(e){return 60*+e};return 2===s.length?(i.h=s[0],i.m=s[1],i.numbers=r(i.h)+o(i.m)):t?(i.m=s[0],i.numbers=o(i.m)):(i.h=s[0],i.numbers=r(i.h)),i.numbers}return 0}}}},1035:(e,t,s)=>{s.d(t,{Z:()=>x}),s(5769),s(3238),s(1418),s(7460),s(4078),s(2077),s(9254),s(9217),s(8010),s(266),s(2327),s(1013),s(1203),s(911),s(5623),s(1514);const i={methods:{sortName:function(e){return _.orderBy(e.books,(function(e){if(e.name)return e.name}),e.direction)}}},r={methods:{sortIsbns:function(e){return _.orderBy(e.books,(function(t){if(!t.isbns)return null;if("isbn10"===e.sortKey){var s=_.find(t.isbns,["type","ISBN_10"]);return s?""+s.identifier:null}if("isbn13"===e.sortKey){var i=_.find(t.isbns,["type","ISBN_13"]);return i?""+i.identifier:null}}),e.direction)}}},o={methods:{sortTitle:function(e){return _.orderBy(e.books,[function(t){var s=t[e.sortKey];return s?"title"===e.sortKey?t.title||t.titleShort:_.isArray(s)&&_.find(s,"name")?_.map(s,"name").join(", "):s:null}],e.direction)}}},n={methods:{sortAmount:function(e){return _.orderBy(e.books,(function(t){if("amountTotal"===e.sortKey){if(t.allBooksMinusDupes)return t.allBooksMinusDupes.length;if(t.allBooks)return t.allBooks.length}else if(t.books)return t.books.length}),e.direction)}}};var a=s(5619);const l={mixins:[a.Z],methods:{sortLength:function(e){var t=this;return _.orderBy(e.books,(function(e){return e.length?t.timeStringToSeconds(e.length):0}),e.direction)}}};s(5163);const c={methods:{sortRatings:function(e){return _.orderBy(e.books,(function(t){if(t[e.sortKey]){var s=t[e.sortKey];return Number(s)}return 0}),e.direction)}}},u={methods:{sortByLength:function(e){return _.orderBy(e.books,(function(t){if("narratorsNumber"===e.sortKey){if(t.narrators){var s=_.find(t.narrators,(function(e){return e.name.match("full cast")}));return s&&1===t.narrators.length?99999999:t.narrators.length-(s?1:0)}return 0}return t[e.sortKey].length||0}),e.direction)}}},h={mixins:[a.Z],methods:{sortProgress:function(e){var t=this;return _.orderBy(e.books,[function(e){if(e.progress){if("finished"===e.progress.toLowerCase().trim())return 100;if(e.length){var s=t.timeStringToSeconds(e.progress),i=t.timeStringToSeconds(e.length);return(s=i-s)/i*100}return 0}return 0},function(e){return e.length?!t.timeStringToSeconds(e.length):0}],e.direction)}}},p={methods:{sortDateAdded:function(e){return _.orderBy(e.books,(function(e){return e.added}),e.direction)}}},m={methods:{sortFavorites:function(e){return _.orderBy(e.books,(function(e){return e.favorite}),e.direction)}}},d={methods:{sortWhispersync:function(e){return _.orderBy(e.books,(function(t){var s=t[e.sortKey];return s?"owned"===s?2:"available"===s?1:void 0:0}),e.direction)}}};s(7471),s(2482),s(3512);const f={mixins:[i,r,o,n,l,c,h,u,p,m,d,{methods:{sortBookNumbers:function(e){var t=this.$route.params.series,s=_.find(this.$store.state.library.series,{asin:t});return _.orderBy(e.books,(function(e){return s.books.indexOf(e.asin)}),e.direction)},sortBookNumbersOriginal:function(e){var t=this.$route.params.series;return _.orderBy(e.books,(function(e){var s=function(e){!_.isEmpty(e)&&e||(e=void 0);var t=_.isArray(e)?e[0]:e,s="string"==typeof t?t.split("-"):[t];return s[0]?parseFloat(s[0]):s[0]};if(t&&e.series)return s(_.find(e.series,{asin:t}).bookNumbers);if(_.find(e.series,"bookNumbers")){var i=_.filter(e.series,"bookNumbers");return i=_.map(i,"bookNumbers"),s(i=_.flatten(i))}return _.find(e.series)?-1:-2}),e.direction)}}},{methods:{sortReleaseDate:function(e){return _.orderBy(e.books,(function(e){return e.releaseDate?new Date(e.releaseDate.split("-").join("/")):0}),e.direction)}}},{methods:{sortStringNameProp:function(e){var t=e.sortKey.replace(".name","");return _.orderBy(e.books,(function(e){return e[t]?e[t][0].name.toLowerCase():null}),e.direction)}}},{methods:{sortMissing:function(e){return _.orderBy(e.books,[function(e){return e.allBooksMinusDupes?e.allBooksMinusDupes.length-e.books.length:e.allBooks?e.allBooks.length-e.books.length:0},function(e){return e.myRating}],[e.direction,"desc"])}}}],methods:{filterBooks:function(e){var t=_.filter(this.$store.state.listRenderingOpts.filter,{type:"filter",active:!0}),s=_.find(this.$store.state.listRenderingOpts.filter,{type:"filter"}),i=_.filter(this.$store.state.listRenderingOpts.filter,{type:"filterExtras",active:!0});return t||i?_.filter(e,(function(e){return function(e){var r=_.map(t,(function(t){return!!t.condition(e)})),o=_.map(i,(function(t){return!!t.condition(e)}));return(!s||_.includes(r,!0))&&!_.includes(o,!1)}(e)})):e},sortBooks:function(e){var t=_.find(this.$store.state.listRenderingOpts.sort,(function(e){return!("randomize"!==e.key||!e.active)||!!e.current||void 0}));if(t){var s={books:e,direction:t.active?"desc":"asc",sortKey:t.key};switch(s.sortKey){case"randomize":e=_.shuffle(e);break;case"bookNumbers":s.missingNumber=0,e=this.sortBookNumbersOriginal(s);break;case"seriesOrder":s.missingNumber=0,e=this.sortBookNumbers(s);break;case"added":e=this.sortDateAdded(s);break;case"releaseDate":e=this.sortReleaseDate(s);break;case"authors.name":case"narrators.name":case"publishers.name":case"categories":case"tags.name":e=this.sortStringNameProp(s);break;case"narratorsNumber":e=this.sortByLength(s);break;case"title":case"series":case"format":case"isNew":case"language":case"fromPlusCatalog":case"unavailable":case"favorite":case"downloaded":case"storePageMissing":case"storePageChanged":case"archived":e=this.sortTitle(s);break;case"whispersync":e=this.sortWhispersync(s);break;case"length":e=this.sortLength(s);break;case"myRating":case"rating":case"ratings":e=this.sortRatings(s);break;case"progress":e=this.sortProgress(s);break;case"favorite":e=this.sortFavorites(s);break;case"name":e=this.sortName(s);break;case"amount":case"amountTotal":e=this.sortAmount(s);break;case"isbn10":case"isbn13":e=this.sortIsbns(s);break;case"missing":e=this.sortMissing(s)}}return e}}},g={name:"searchIcons",props:["listName"],data:function(){return{items:[{name:"scope",on:!0,active:!1,icon:"microscope",tooltip:"Change the search scope for more accurate results"},{name:"filter",on:!0,active:!1,icon:"filter",tooltip:"Filter books"},{name:"sort",on:!0,active:!1,icon:"sort",tooltip:"Sort books"}]}},computed:{filtersActive:function(){return this.$store.getters.filterExtrasKeys||"notStarted,started,finished"!==this.$store.getters.filterKeys&&this.$store.getters.filterKeysLength}},methods:{openSearchOptions:function(e,t){var s=this.listName;this.$emit("update:listName",!1),s!==e.name&&this.$nextTick((function(){this.$emit("update:listName",e.name)}))},showIcon:function(e){switch(e.name){case"scope":return this.$store.state.listRenderingOpts[e.name].length>0;case"filter":var t=!this.$store.getters.regularFilters;return _.filter(this.$store.state.listRenderingOpts[e.name],(function(s){var i="divider"===s.type,r=!!t||s.type===e.name;return!i&&r})).length>0;case"sort":return _.filter(this.$store.state.listRenderingOpts[e.name],(function(t){var s="divider"===t.type,i=t.type===e.name;return!s&&i})).length>0}}}};var v=s(810);const y=(0,v.Z)(g,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"icons"},[s("div",{directives:[{name:"tippy",rawName:"v-tippy"}],staticClass:"icon-wrap",attrs:{content:"Items in current selection: <strong>"+e.$store.getters.collection.length+"</strong> / <strong>"+e.$store.getters.collectionTotal+"</strong>"}},[s("div",{staticClass:"book-in-selection"},[s("div",{staticClass:"inner-wrap"},[e._v("\n        "+e._s(e.$store.getters.collection.length)+"\n      ")])])]),e._v(" "),e._l(e.items,(function(t){return e.showIcon(t)?s("div",{directives:[{name:"tippy",rawName:"v-tippy"}],key:t.name,staticClass:"icon-wrap",class:{disabled:!t.on},attrs:{content:t.tooltip},on:{click:function(s){return e.openSearchOptions(t,s)}}},[s("div",{staticClass:"search-opt-btn",class:{active:e.listName===t.name,"active-filters":"filter"===t.name&&e.filtersActive},attrs:{"data-option":t.name}},[s("font-awesome",{attrs:{fas:"",icon:t.icon}})],1)]):e._e()}))],2)}),[],!1,null,"b579a0e6",null).exports,b={name:"searchOptions",props:["listName"],components:{sorter:s(8111).default},data:function(){return{css:{arrow:{left:"0px"},options:{right:"0px"},filter:{top:"40px"}}}},created:function(){if(this.$store.commit("prop",{key:"lazyScroll",value:!1}),this.$updateQuery({query:"y",value:null}),this.optionsList=this.$store.state.listRenderingOpts[this.listName],"filter"===this.listName){var e=document.querySelector("#nav-outer-wrapper.regular .inner-wrap");this.css.filter={top:e?e.offsetHeight+"px":0}}},mounted:function(){this.repositionSearchOptions(),this.$root.$on("repositionSearchOpts",this.repositionSearchOptions),this.$root.$on("afterWindowResize",this.repositionSearchOptions)},beforeDestroy:function(){this.$root.$off("repositionSearchOpts",this.repositionSearchOptions),this.$root.$off("afterWindowResize",this.repositionSearchOptions),scroll({top:0,behavior:"smooth"}),this.$store.commit("prop",{key:"searchOptOpenHeight",value:null}),this.$store.commit("prop",{key:"lazyScroll",value:!0})},methods:{resetFilters:function(){this.$updateQuery({query:"filter",value:null}),this.$updateQuery({query:"filterExtras",value:null}),this.$store.commit("resetFilters"),this.$root.$emit("start-filter")},repositionSearchOptions:_.debounce((function(){this.$nextTick((function(){if("filter"===this.listName){var e=document.querySelector("#nav-outer-wrapper.regular .inner-wrap");this.css.filter={top:e?e.offsetHeight+"px":0}}var t={};t.el=this.$refs.options,t.width=t.el.offsetWidth,t.left=t.el.offsetLeft;var s={};s.el=document.querySelector("#ale-search > .icons"),s.width=s.el.offsetWidth;var i={};i.el=document.querySelector(".search-opt-btn.active").parentNode,i.width=i.el.offsetWidth,i.left=i.el.offsetLeft,i.middle=s.width-(i.left+i.width/2),t.position=i.middle-t.width/2;var r=i.el.getBoundingClientRect().left+i.width/2+t.width/2-window.innerWidth,o=r>0?r+20:0;this.css.options.right=t.position+o+"px",this.css.arrow.left=t.width/2-10+o+"px"}))}),150,{leading:!0,trailing:!1}),sortersMounted:_.debounce((function(){if(this.$refs.options){var e=this.$refs.options.offsetHeight+this.$refs.options.offsetTop;window.innerHeight>e?e=window.innerHeight:e+=100,this.$store.commit("prop",{key:"searchOptOpenHeight",value:e})}}),250,{leading:!1,trailing:!0})}},$=(0,v.Z)(b,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{ref:"options",class:e.listName+"-options",style:e.css.options,attrs:{id:"search-options"}},[s("div",{staticClass:"search-options-inner-wrap"},[s("div",{staticClass:"search-opts-arrow",style:e.css.arrow}),e._v(" "),"filter"===e.listName&&e.$store.getters.regularFilters?s("ul",{staticClass:"regular-filters",style:e.css.filter},[s("li",{directives:[{name:"tippy",rawName:"v-tippy",value:{placement:"top",flipBehavior:["top","right","bottom","left"]},expression:"{ placement: 'top', flipBehavior: ['top', 'right', 'bottom', 'left'] }"}],staticClass:"reset-filters",attrs:{content:"Reset filters"},on:{click:e.resetFilters}},[s("font-awesome",{attrs:{fas:"",icon:"redo-alt"}})],1),e._v(" "),s("li",{staticClass:"total"},[s("span",{class:{difference:e.$store.getters.collection.length!==e.$store.getters.collectionTotal}},[e._v(e._s(e.$store.getters.collection.length))]),e._v(" / "+e._s(e.$store.getters.collectionTotal))]),e._v(" "),e._l(e.optionsList,(function(t,i){return("wishlist"===e.$route.name?"filter"!==t.type||t.excludeFromWishlist:"filter"!==t.type)?e._e():s("li",{key:t.key,staticClass:"search-option"},[s("sorter",{attrs:{label:t.label,item:t,index:i,currentList:e.optionsList,listName:e.listName},on:{"hook:mounted":e.sortersMounted}})],1)}))],2):e._e(),e._v(" "),s("ul",e._l(e.optionsList,(function(t,i){return("wishlist"===e.$route.name?t.excludeFromWishlist||"grid"!==e.$store.state.sticky.viewMode&&"sortValues"===t.key||"filter"===t.type:"grid"!==e.$store.state.sticky.viewMode&&"sortValues"===t.key||"filter"===t.type)?e._e():s("li",{key:t.key,staticClass:"search-option",class:{extras:t.type&&t.type.match(/extra/i),divider:"divider"===t.type}},["divider"!==t.type?s("sorter",{attrs:{label:t.label,item:t,index:i,currentList:e.optionsList,listName:e.listName},on:{"hook:mounted":e.sortersMounted}}):e._e()],1)})),0)])])}),[],!1,null,null,null).exports;var k=s(9846),w=s(9977);const S={name:"aleSearch",components:{searchIcons:y,searchOptions:$,viewModeSwitcher:function(){return s.e("view-mode-switcher").then(s.bind(s,2054))},pageTitle:k.Z,libraryWishlistSwitcher:w.Z},mixins:[f],props:["collectionSource","pageTitle","pageSubTitle"],data:function(){return{enableZoomTimer:null,fuse:null,fuseOptions:{keys:["title"],location:0,distance:350,threshold:.15,shouldSort:!0,includeScore:!1,includeMatches:!1,useExtendedSearch:!0},listName:!1,waypointOpts:{rootMargin:"-37px"},fixedSearch:!1,highlightSearch:!1,readyToCloseOpts:!1}},mounted:function(){if(this.$route.query.search){var e=decodeURIComponent(this.$route.query.search);this.$store.commit("prop",{key:"searchQuery",value:e})}this.$store.commit("prop",{key:"collectionSource",value:this.collectionSource});var t=this.$route.query.sort||this.$route.query.filter||this.$route.query.filterExtras,s=_.get(this.$store.state,this.collectionSource);t?((this.$route.query.filter||this.$route.query.filterExtras)&&(s=this.filterBooks(s)),this.$route.query.sort&&(s=this.sortBooks(s)),this.$store.commit("prop",{key:"mutatingCollection",value:s})):this.$store.commit("prop",{key:"mutatingCollection",value:this.sortBooks(this.filterBooks(s))}),this.$route.query.search&&(this.$route.query.sort&&(this.fuseOptions.shouldSort=!1),this.search(this.$event,"on-load")),this.$refs.aleSearch.addEventListener("touchstart",this.iosAutozoomDisable,{passive:!0}),this.$root.$on("ios-auto-zoom-disable",this.iosAutozoomDisable),this.$root.$on("start-scope",this.scope),this.$root.$on("start-sort",this.sort),this.$root.$on("start-filter",this.filter),this.$root.$on("search-focus",this.focusOnSearch),this.$store.commit("prop",{key:"searchMounted",value:!0})},beforeDestroy:function(){this.$store.commit("prop",{key:"searchQuery",value:""}),this.$refs.aleSearch.removeEventListener("touchstart",this.iosAutozoomDisable),this.$root.$off("ios-auto-zoom-disable",this.iosAutozoomDisable),this.$root.$off("start-scope",this.scope),this.$root.$off("start-sort",this.sort),this.$root.$off("start-filter",this.filter),this.$root.$off("search-focus",this.focusOnSearch),this.$store.commit("prop",{key:"searchMounted",value:!1})},methods:{dontCloseOpts:_.throttle((function(){this.readyToCloseOpts&&(this.readyToCloseOpts=!1)}),50,{leading:!1,trailing:!0}),closeOpts:function(){this.readyToCloseOpts&&(this.readyToCloseOpts=!1,this.$nextTick((function(){var e=this;setTimeout((function(){e.listName=!1}),30)})))},scope:function(){this.$root.$emit("book-clicked",{book:null}),this.$store.getters.searchIsActive&&(this.$store.commit("prop",{key:"mutatingCollection",value:this.sortBooks(this.filterBooks(_.get(this.$store.state,this.collectionSource)))}),this.$store.getters.searchIsActive||(this.fuseOptions.shouldSort=!1),this.search())},filter:function(){this.$root.$emit("book-clicked",{book:null}),this.$store.commit("prop",{key:"mutatingCollection",value:this.sortBooks(this.filterBooks(_.get(this.$store.state,this.collectionSource)))}),this.$store.getters.searchIsActive&&(this.$store.getters.searchIsActive||(this.fuseOptions.shouldSort=!1),this.search())},sort:function(){this.$root.$emit("book-clicked",{book:null}),this.$store.commit("prop",{key:this.$store.getters.searchIsActive?"searchCollection":"mutatingCollection",value:this.sortBooks(this.$store.getters.collection)})},search:_.debounce((function(e,t){if(decodeURIComponent(this.$route.query.search),t||this.$root.$emit("book-clicked",{book:null}),e)if(this.fuseOptions.shouldSort=!0,this.$store.commit("prop",{key:"searchQuery",value:e.target.value}),this.$updateQuery({query:"search",value:encodeURIComponent(e.target.value)}),""!==e.target.value.trim())this.$route.query.sort&&(this.$updateQuery({query:"sort",value:null}),this.$updateQuery({query:"sortDir",value:null}));else{var i=_.find(this.$store.state.listRenderingOpts.sort,"current");this.$updateQuery({query:"sort",value:i.key}),this.$updateQuery({query:"sortDir",value:i.active?"desc":"asc"})}if(this.$store.getters.searchIsActive){var r=this.modifyQuery(this.$store.state.searchQuery);this.fuseOptions.keys=this.aliciaKeys;var o=this;s.e("fuse-search").then(s.bind(s,2631)).then((function(e){o.fuse=new e.default(o.$store.state.mutatingCollection,o.fuseOptions);var t=o.fuse.search(r);t.length>0&&(t=_.map(t,(function(e){return e.item}))),o.$store.commit("prop",{key:"searchCollection",value:t})}))}else this.$store.commit("prop",{key:"searchCollection",value:[]})}),270,{leading:!1,trailing:!0}),searchEnterBlur:_.debounce((function(e){this.$refs.searchInput.blur()}),100,{leading:!1,trailing:!0}),restoreOptions:function(){updateListRenderingOpts()},focusOnSearch:function(){var e=this;scroll({top:0}),this.highlightSearch=!0,setTimeout((function(){e.highlightSearch=!1}),1200),this.$refs.searchInput.focus()},modifyQuery:function(e){var t=e.match(/&/),s=e.match(/ ?and ?/);return t?e+"|"+e.replace("&","and"):s?e+"|"+e.replace("and","&"):e},iosAutozoomDisable:function(){if(document.querySelector(".is-ios")){var e=document.querySelector("head").querySelector("meta[name=viewport]");e.content="width=device-width, initial-scale=1.0, user-scalable=0",clearTimeout(this.enableZoomTimer),this.enableZoomTimer=setTimeout((function(){e.content="width=device-width, initial-scale=1.0, user-scalable=1"}),700)}}},computed:{aliciaKeys:function(){var e=_.filter(this.$store.state.listRenderingOpts.scope,["active",!0]);return _.map(e,(function(e){if(e.active)return e.key}))},placeholder:function(){var e;return"Search: "+(e=this.aliciaKeys,_.map(e,(function(e){return e.replace(".name","")})).join(", "))}}},x=(0,v.Z)(S,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.pageTitle||e.pageSubTitle?s("page-title",{attrs:{pageTitle:e.pageTitle,pageSubTitle:e.pageSubTitle}}):e._e(),e._v(" "),e.$route.meta.subPage?s("library-wishlist-switcher",{attrs:{aboveSearch:!0}}):e._e(),e._v(" "),s("div",{ref:"searchWrap",class:{"search-fixed":e.fixedSearch,"highlight-search":e.highlightSearch},attrs:{id:"ale-search-wrap"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.listName,expression:"listName"}],attrs:{id:"search-dropdown-overlay"},on:{mousedown:function(t){e.readyToCloseOpts=!0},touchstart:function(t){e.readyToCloseOpts=!0},touchmove:e.dontCloseOpts,click:e.closeOpts}}),e._v(" "),s("div",{ref:"aleSearch",attrs:{id:"ale-search"}},[s("div",{staticClass:"search-wrapper",on:{click:function(t){return e.$refs.searchInput.focus()}}},[s("input",{ref:"searchInput",attrs:{type:"search",placeholder:e.placeholder},domProps:{value:e.$store.state.searchQuery},on:{input:e.search,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchEnterBlur.apply(null,arguments)},focus:function(t){e.listName=!1}}})]),e._v(" "),s("search-icons",{attrs:{"list-name":e.listName},on:{"update:listName":function(t){e.listName=t},"update:list-name":function(t){e.listName=t}}}),e._v(" "),e.listName?s("search-options",{attrs:{"list-name":e.listName},on:{"update:listName":function(t){e.listName=t},"update:list-name":function(t){e.listName=t}}}):e._e()],1),e._v(" "),e.$route.meta.gallery&&e.$store.state.windowWidth>=450?s("view-mode-switcher"):e._e()],1)],1)}),[],!1,null,null,null).exports},9977:(e,t,s)=>{s.d(t,{Z:()=>i});const i=(0,s(810).Z)({name:"libraryWishlistSwitcher",props:["aboveSearch"],created:function(){},methods:{switcher:function(e){this.$updateQuery({query:"subPageSource",value:e}),this.$updateQuery({query:"filterExtras",value:null}),this.$updateQuery({query:"sort",value:null}),this.$updateQuery({query:"sortDir",value:null}),this.$store.commit("stickyProp",{key:"subPageSource",value:e}),this.$root.$emit("refresh-page")}}},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.$route.meta.subPage&&!e.$route.meta.gallery&&(e.$store.state.library.books||e.$store.state.library.extras.pages.books)&&(e.$store.state.library.wishlist||e.$store.state.library.extras.pages.wishlist)?s("div",{class:{"above-search":e.aboveSearch},attrs:{id:"library-wishlist-switcher"}},[s("button",{class:{active:"books"===(e.$route.query.subPageSource||e.$store.state.sticky.subPageSource)},on:{click:function(t){return e.switcher("books")}}},[e._v("\n    Library\n  ")]),e._v(" "),s("button",{class:{active:"wishlist"===(e.$route.query.subPageSource||e.$store.state.sticky.subPageSource)},on:{click:function(t){return e.switcher("wishlist")}}},[e._v("\n    Wishlist\n  ")])]):e._e()}),[],!1,null,"14281d6c",null).exports},9846:(e,t,s)=>{s.d(t,{Z:()=>i});const i=(0,s(810).Z)({name:"pageTitle",props:["pageTitle","pageSubTitle"],mounted:function(){this.pageTitle&&this.$store.commit("prop",{key:"pageTitle",value:this.pageTitle}),this.pageSubTitle&&this.$store.commit("prop",{key:"pageSubTitle",value:this.pageSubTitle})},beforeDestroy:function(){this.$store.commit("prop",{key:"pageTitle",value:null})}},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.pageTitle||e.pageSubTitle?s("div",{staticClass:"gallery-title-wrapper"},[e.pageTitle?s("h2",{staticClass:"gallery-title"},[e._v("\n    "+e._s(e.pageTitle)+"\n  ")]):e._e(),e._v(" "),s("div",{staticClass:"divider"}),e._v(" "),e.pageSubTitle?s("h3",{staticClass:"gallery-sub-title"},[e._v("\n    "+e._s(e.pageSubTitle)+"\n  ")]):e._e()]):e._e()}),[],!1,null,null,null).exports},8111:(e,t,s)=>{s.r(t),s.d(t,{default:()=>r}),s(5769),s(3238),s(1418),s(7460),s(4078),s(2077),s(1203),s(8010),s(1013),s(5623),s(1514),s(9217),s(5699),s(2482),s(2327);const i={name:"sorter",props:["label","currentList","listName","item","index","tippyTop"],mixins:[s(730).Z],components:{VueSlider:function(){return s.e("rangeslider-and-multiselect").then(s.t.bind(s,7865,23))},Multiselect:function(){return s.e("rangeslider-and-multiselect").then(s.bind(s,6813))}},data:function(){return{range:null,dropdownOptions:null}},created:function(){if(this.item.range){var e={min:this.item.rangeMin(),max:this.item.rangeMax()};e.min<0&&(e.min=0),e.max<0&&(e.max=0),e.min>e.max&&(e.min=e.max),_.isArray(this.item.range)?(e.value=_.clone(this.item.range),(e.value[0]<e.min||e.value[0]>e.max)&&(e.value[0]=e.min),(e.value[1]<e.min||e.value[1]>e.max)&&(e.value[1]=e.max)):e.value=[e.min,e.max],this.item.rangeMarks&&(e.marks=this.item.rangeMarks(e.max)),this.range=e}else this.$store.getters.filterExtrasKeys.match(this.item.key)&&!this.dropdownOptions&&this.item.dropdownOpts&&(this.dropdownOptions=this.item.dropdownOpts())},computed:{filterAmounts:function(){this.$root.$emit("repositionSearchOpts");var e=!(this.item.range||this.item.dropdownOpts),t=!e&&!0===this.item.active;if(e||t){var s=this,i=_.filter(this.$store.state.listRenderingOpts.filter,{type:"filterExtras",active:!0}),r="filter"===this.item.type?this.$store.getters.searchIsActive?this.$store.state.searchCollection:this.$store.getters.collectionSource:this.$store.getters.collection;return _.filter(r,(function(e){return s.item.condition(e)&&function(e){var t=_.map(i,(function(t){return!!t.condition(e)}));return!_.includes(t,!1)}(e)})).length}return 0},rangeVal:function(){return this.range.value},inputVmodel:{get:function(){return this.item.active},set:function(e){var t={listName:this.listName,index:this.index,active:e};this.item.range&&(t.range=!e||_.clone(this.range.value)),this.item.group&&(t.group=!0),this.$store.commit("updateListRenderingOpts",t),this.doTheThings(e)}},isActiveSortItem:function(){if("sort"===this.listName){if(!this.$store.getters.searchIsActive||this.$store.getters.searchIsActive&&this.$route.query.sort)return _.findIndex(this.currentList,"current")===this.index}else if("filter"===this.listName)return!1}},methods:{tooltipFormatter:function(e){return e+this.item.rangeSuffix},dropdownChanged:function(e){var t={listName:this.listName,index:this.index,active:e.length>0,value:e};this.item.group&&(t.group=!0),this.$store.commit("updateListRenderingOpts",t),this.doTheThings(e,!0)},dropdownOpened:function(e){!this.dropdownOptions&&this.item.dropdownOpts&&(this.dropdownOptions=this.item.dropdownOpts())},rangeChanged:function(e){this.range.value=e;var t={listName:this.listName,index:this.index,range:e,active:!0};this.item.group&&(t.group=!0),this.$store.commit("updateListRenderingOpts",t),this.doTheThings(e,!0)},adjustRange:function(e){var t={listName:this.listName,index:this.index,active:!0,range:[0,0]};if("left"===e){var s=this.range.min;t.range[0]=s,this.range.value=[s,this.range.value[1]]}else{var i=this.range.max;t.range[1]=i,this.range.value=[this.range.value[0],i]}this.item.group&&(t.group=!0),this.$store.commit("updateListRenderingOpts",t),this.doTheThings(t.range,!0)},doTheThings:function(e,t){this.saveOptions(e,t),"sortValues"===this.item.key&&this.$root.$emit("book-clicked",{book:null}),"scope"===this.listName?this.$root.$emit("start-scope"):"sort"!==this.listName&&("randomize"!==this.item.key||this.$store.getters.searchIsActive)||"sortValues"===this.item.key?"filter"===this.listName&&this.$root.$emit("start-filter"):(this.$store.commit("prop",{key:"searchSort",value:!1}),this.$root.$emit("start-sort"))},saveOptions:function(e,t){if("sortValues"===this.item.key)this.$updateQuery({query:this.item.key,value:e});else if("sort"===this.item.type)this.$updateQuery({query:this.item.type,value:this.item.key}),this.$updateQuery({query:"sortDir",value:e?"desc":"asc"});else if("filter"===this.listName){if("filter"===this.item.type&&this.$updateQuery({query:this.item.type,value:encodeURIComponent(this.$store.getters.filterKeys)}),"filterExtras"===this.item.type){var s=this,i=_.map(s.$store.getters.filterExtrasKeys.split(","),(function(e){var t=_.find(s.$store.state.listRenderingOpts.filter,{key:e});return t&&t.range?encodeURIComponent(e+":"+s.range.value[0]+"-"+s.range.value[1]):t&&t.value&&t.value.length>0?encodeURIComponent(e+":")+_.map(t.value,(function(e){return encodeURIComponent(e)})).join("|"):e?encodeURIComponent(e):void 0}));this.$updateQuery({query:this.item.type,value:(1!==i.length||void 0!==i[0])&&i.join(",")})}}else"scope"===this.listName&&this.$updateQuery({query:this.listName,value:encodeURIComponent(this.$store.getters.scopeKeys)})}}},r=(0,s(810).Z)(i,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"sorter-button-wrapper"},[e.item?s("span",{directives:[{name:"tippy",rawName:"v-tippy",value:{delay:150,maxWidth:350,placement:e.tippyTop?"top":"left",flipBehavior:e.tippyTop?["top","bottom","left","right"]:["left","top","bottom","right"],distance:e.listName?20:10},expression:"{ \n    delay: 150,\n    maxWidth: 350, \n    placement: (tippyTop ? 'top' : 'left'), \n    flipBehavior: (tippyTop ? ['top', 'bottom', 'left', 'right'] : ['left', 'top', 'bottom', 'right']),\n    distance: listName ? 20 : 10,\n  }"}],class:e.item.key,attrs:{content:!!e.item.tippy&&e.item.tippy}},[s("label",{staticClass:"sorter-button",class:{ranged:e.item.range,"faux-disabled":"filterExtras"===e.item.type&&e.filterAmounts<1,"is-dropdown":e.item.dropdownOpts}},[!1===e.label?s("span",{staticClass:"input-label",class:{active:e.isActiveSortItem}},[e._t("default")],2):e._e(),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.inputVmodel,expression:"inputVmodel"}],attrs:{type:"checkbox"},domProps:{value:e.index,checked:Array.isArray(e.inputVmodel)?e._i(e.inputVmodel,e.index)>-1:e.inputVmodel},on:{change:function(t){var s=e.inputVmodel,i=t.target,r=!!i.checked;if(Array.isArray(s)){var o=e.index,n=e._i(s,o);i.checked?n<0&&(e.inputVmodel=s.concat([o])):n>-1&&(e.inputVmodel=s.slice(0,n).concat(s.slice(n+1)))}else e.inputVmodel=r}}}),e._v(" "),"sort"===e.item.type?s("span",{staticClass:"sortbox",class:{active:e.isActiveSortItem}},[s("font-awesome",{attrs:{fas:"",icon:"sort-down"}}),e._v(" "),s("font-awesome",{attrs:{fas:"",icon:"sort-up"}})],1):e.item.radiobutton?s("span",{staticClass:"radiobutton"},[s("font-awesome",{attrs:{fas:"",icon:"circle"}}),e._v(" "),s("font-awesome",{attrs:{fas:"",icon:"circle"}})],1):s("span",{staticClass:"checkbox"},[s("font-awesome",{attrs:{fas:"",icon:"square"}}),e._v(" "),s("font-awesome",{attrs:{fas:"",icon:"check"}})],1),e._v(" "),!1!==e.label?s("span",{staticClass:"input-label",class:{active:e.isActiveSortItem}},[e._v("\n        "+e._s(e.item.label||e.item.key.replace(".name",""))+"\n      ")]):e._e(),e._v(" "),"filter"===e.listName?s("span",{staticClass:"books-in-filter"},[e._v("\n        "+e._s(e.filterAmounts)+"\n        ")]):e._e()]),e._v(" "),e.item.range?s("div",{staticClass:"range-slider"},[s("span",{staticStyle:{"font-size":"13px","line-height":"13px",cursor:"w-resize"},on:{click:function(t){return e.adjustRange("left")}}},[e._v(e._s(e.range.value[0])+e._s(e.item.rangeSuffix))]),e._v(" "),s("vue-slider",{attrs:{disabled:e.range.disabled,dragOnClick:!0,adsorb:!0,lazy:!0,hideLabel:!0,included:!!e.range.marks,interval:e.range.min===e.range.max?1:e.item.rangeInterval||1,marks:e.range.marks||Math.abs(e.range.min-e.range.max)<=10,value:e.range.value,min:e.range.min,max:e.range.max,"min-range":e.range.min===e.range.max?0:e.item.rangeMinDist||0,"enable-cross":!1,"tooltip-formatter":e.item.tooltipFormatter||e.tooltipFormatter,"tooltip-placement":"top",tooltip:"active","use-keyboard":!1},on:{change:e.rangeChanged,"drag-start":function(t){return e.$store.commit("prop",{key:"searchOptCloseGuard",value:!0})},"drag-end":function(t){return e.$store.commit("prop",{key:"searchOptCloseGuard",value:!1})}}}),e._v(" "),s("span",{staticStyle:{"font-size":"13px","line-height":"13px",cursor:"e-resize"},on:{click:function(t){return e.adjustRange("right")}}},[e._v(e._s(e.range.value[1])+e._s(e.item.rangeSuffix))])],1):e._e(),e._v(" "),e.item.dropdownOpts?s("div",[s("Multiselect",{ref:"multiselect",attrs:{value:e.item.value,placeholder:"Search...",options:e.dropdownOptions,mode:"tags",hideSelected:!0,clearOnSelect:!1,closeOnSelect:!1,multiple:!0,taggable:!0,searchable:!0},on:{change:e.dropdownChanged,open:e.dropdownOpened}})],1):e._e()]):e._e()])}),[],!1,null,"46db10ae",null).exports}}]);